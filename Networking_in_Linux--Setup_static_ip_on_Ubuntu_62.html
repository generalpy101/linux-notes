<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Setup static ip on Ubuntu</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Setup static ip on Ubuntu</h1><br/><p>netplan is used to configure static network settings in ubuntu after ubuntu 17.10.</p><p></p><p><img src="images/62-1.png" alt="images/62-1.png" /></p><p>yaml files in netplan directory holds the configurations.</p><p></p><p>The netplan uses two renderers or backends to manage network : network manager which is used in desktop(gui) environment and networkd and systemd which are used in devices without gui(like servers).</p><p></p><p>Changing network config using network manager renderer is easy as it is done by gui.</p><p></p><p>1. Click on network settings icon available in top right of the sytem.</p><p><img src="images/62-2.png" alt="images/62-2.png" />&#39;</p><p>2. A window like below will open, click on gear icon in front of network enable switch.</p><p><img src="images/62-3.png" alt="images/62-3.png" /></p><p>3. A window like below will appear. Go to ipv4 or ipv6 tab according to your lan config and then click on manual radio button and enter the required details. Click on apply when done.</p><p><img src="images/62-4.png" alt="images/62-4.png" /></p><p></p><p>To change settings when gui is not available(using systemd and networkd <small>renderer</small>).</p><p></p><p>Network Manger and networkd are used to change network config but they cannot work at the same time so we have to disable Network Manager.</p><p></p><p>We first stopped the network manager service and then disabled it so that it doesn&#39;t start on boot and interfere with our current networkd config.</p><p><img src="images/62-5.png" alt="images/62-5.png" /></p><p></p><p>If we don&#39;t use NetworkManager anymore, it is recommended to move existing config file from the /etc/netplan directory.</p><p></p><p>We then have to create our own yaml file inside /etc/netplan. Use meaningful names like 01-netconfig.yaml. Note that yaml files use 2 spaces for indentations, so mind spaces carefully. Use yaml verifiers to check validity of yaml file if you have a doubt.</p><p>netplan files must have 3 components.</p><p></p><p><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">network</span>:<br />  <span style="color:#ff9d00;font-weight:700">version</span>:<br />  <span style="color:#ff9d00;font-weight:700">renderer</span>:<br />  <span style="color:#ff9d00;font-weight:700">devices</span>:</pre></div></p><p>The netplan yaml file begins with network keyword then we have version used, renderer used and then devices which can be ethernets in case of ethernet or wifis in case of wifi(idk about others <small>rn</small>). Sample netplan config.</p><p></p><p><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">network</span>:<br />  <span style="color:#ff9d00;font-weight:700">version</span>: <span style="color:#ff0044;font-weight:400">2</span><br />  <span style="color:#ff9d00;font-weight:700">renderer</span>: <span style="color:#3ad900;font-weight:400">networkd</span><br />  <span style="color:#ff9d00;font-weight:700">ethernets</span>:<br />    <span style="color:#ff9d00;font-weight:700">enp0s3</span>:<br />      <span style="color:#ff9d00;font-weight:700">dhcp4</span>: <span style="color:#ff0044;font-weight:400">false</span><br />      <span style="color:#ff9d00;font-weight:700">addresses</span>:<br />        - <span style="color:#3ad900;font-weight:400">192.168.0.220/24</span><br />      <span style="color:#ff9d00;font-weight:700">gateway4</span>: <span style="color:#3ad900;font-weight:400">&quot;192.168.0.1&quot;</span><br />      <span style="color:#ff9d00;font-weight:700">nameservers</span>:<br />        <span style="color:#ff9d00;font-weight:700">addresses</span>:<br />          - <span style="color:#3ad900;font-weight:400">&quot;8.8.8.8&quot;</span><br />          - <span style="color:#3ad900;font-weight:400">&quot;4.4.4.4&quot;</span> </pre></div></p><p></p><p>Above file is of v2 and uses networkd as renderer. We defined ethernet properties on our enp0s3 interface, dhcp is false, ip address is 192.168.0.220 with subnet mask of 24, gateway is 192.168.0.1, and we have dns servers under addresses.</p><p></p><p>To apply the config, we use <em>netplan apply</em> command.</p><p></p><p><img src="images/62-6.png" alt="images/62-6.png" /></p><p></p><p>If we want to use dhcp using above file, just set dhcp4 as true and remove all parameters below dhcp4.</p></div>
</body>
</html>
