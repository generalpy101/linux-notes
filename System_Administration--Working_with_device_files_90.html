<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Working with device files</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Working with device files</h1><br/><p>Every device in linux is represented by device files. Device files are basically just interfaces for devices so that we can perform i/o operations by tools that we know.</p><p></p><p>dd command is used to copy and paste but it is very different from normal cp command as it can be used to copy device files.</p><p></p><p>Basic syntax of dd command is :</p><p></p><p><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">dd</span> if=input_file_path of=output_file_path</pre></div></p><p>dd follows a slightly different snytax than simple linux commands. dd uses option=value syntax for its options. Here if stands for input file and of stands for output file.</p><p></p><p>dd is also know as disk destroyer as it can easily erase contents of your disk so use with caution.</p><p></p><p>status option can be used to define show status of the command. status=progress will show progress. It can only be used in dd command from coreutils v8.24 or above.</p><p></p><p>dd will also copy empty files. dd works with blocks and it will copy both empty and occupied space. This is one of the main difference from cp command. For example we have 10 gb partition and 9 is free , dd will copy all 10 gb.</p><p></p><p>We can create backup of partition or removable media like this.</p><p></p><p><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">dd</span> if=usb_in_dev of=destination<span style="color:#ff9d00;font-weight:700">(</span>usually .img <span style="color:#ff9d00;font-weight:700">file</span> is created<span style="color:#ff9d00;font-weight:700">)</span></pre></div></p><p>To extract that backup</p><p><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">dd</span> if=path_to_img_file of=path_to_usb</pre></div></p><p></p><p>EG :</p><p><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">dd</span> if=<span style="color:#ff9d00;font-weight:700">/</span>dev<span style="color:#ff9d00;font-weight:700">/</span>sdb of=<span style="color:#ff9d00;font-weight:700">/</span>home<span style="color:#ff9d00;font-weight:700">/</span>user1<span style="color:#ff9d00;font-weight:700">/</span>backup-usb.img<br /><span style="color:#ff9d00;font-weight:700">dd</span> if=<span style="color:#ff9d00;font-weight:700">/</span>home<span style="color:#ff9d00;font-weight:700">/</span>user1<span style="color:#ff9d00;font-weight:700">/</span>backup-usb.img of=<span style="color:#ff9d00;font-weight:700">/</span>dev<span style="color:#ff9d00;font-weight:700">/</span>sdb</pre></div></p><p></p><p>We can use conv=sync to use syncronised i/o.</p><p></p><p>We can also backup MBR which is Master Boot Record which is a special type of boot sector at the beginning of the disk. It holds the info about the organisation of logical partitions and also holds an executable code known as bootloader and size of MBR is 512 bytes.</p><p></p><p><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">dd</span> if=<span style="color:#ff9d00;font-weight:700">/</span>dev<span style="color:#ff9d00;font-weight:700">/</span>sda of=<span style="color:#ff9d00;font-weight:700">/</span>root<span style="color:#ff9d00;font-weight:700">/</span>mbr.dat block=512 count=1<br /><span style="color:#ff9d00;font-weight:700">dd</span> if=<span style="color:#ff9d00;font-weight:700">/</span>root<span style="color:#ff9d00;font-weight:700">/</span>mbr.dat of=<span style="color:#ff9d00;font-weight:700">/</span>dev<span style="color:#ff9d00;font-weight:700">/</span>sda block=512 count=1</pre></div></p><p></p><p>Here /dev/sda is a disk not a partition. The block options specifies the size of block dd will read at once in bytes and count specifies how many blocks it must read which is 1 here as we have to read MBR which is only on 512 bytes.</p><p></p><p>To create a bootable usb we can use dd.</p><p></p><p>We first have to format it with a file system. Unmount the usb if it is mounted then format it to a filesystem using <em>mkfs.&lt;filesystem&gt;</em>.</p><p></p><p>Then use </p><p><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">dd</span> if=path_to_iso_file of=path_to_usb bs=4M</pre></div></p><p>bs specifies the number of bytes to read at ones which is 512 by default. It is set to 4M which is 4 MB if we format for vfat fs.</p><p></p><p>Command to destroy data in linux.</p><p></p><p><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">dd</span> if=<span style="color:#ff9d00;font-weight:700">/</span>dev<span style="color:#ff9d00;font-weight:700">/</span>zero of=<span style="color:#ff9d00;font-weight:700">/</span>dev<span style="color:#ff9d00;font-weight:700">/</span>sda</pre></div></p><p>/dev/zero is a special device which gives as many number of null characters (0x0) as it is read. This will set data of whole disk to null characters.</p></div>
</body>
</html>
