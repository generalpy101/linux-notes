<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Create,change and delete users</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Create,change and delete users</h1><br/><p>In linux we need root privileges to add,update or delete users.</p><p></p><p><strong>useradd</strong> command is used to add a new user.</p><p></p><p><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">sudo</span> useradd user_name</pre></div></p><p><img src="images/33-1.png" alt="images/33-1.png" /></p><p></p><p>Useradd command without any flags create a user with default options which are specified in /etc/default/useradd file.</p><p><img src="images/33-2.png" alt="images/33-2.png" /></p><p></p><p>By default for new user group with same name is created.</p><p></p><p><img src="images/33-3.png" alt="images/33-3.png" /></p><p></p><p>Default options for useradd ,may differ from distro to distro.</p><p></p><p>Note that useradd also reads the /etc/login.defs file which create instructions for shadow file like password expiration policy, allowed range of passwords etc.</p><p></p><p>To be able to login as new user we have to assign that account a password.</p><p></p><p>To assign or edit a password, we can run passwd command with name of user as argument.</p><p></p><p><img src="images/33-4.png" alt="images/33-4.png" /></p><p></p><p>If we provide no options to useradd command, user&#39;s home directory is not created in /home/.</p><p></p><p>User -m option to create user&#39;s home directory. This will create home directory for user with same name as username in /home directory. We can create home directory in different location by using -d flag.</p><p></p><p>To add comment in /etc/passwd user -c option.</p><p></p><p>To use a different shell user -s option followed by absolute path of that shell. This shell is then launched when user logs in or opens a terminal.</p><p></p><p>By default, user is added into primary group with name same as username. To change this use -g option followed by group name, but this practice is not so common. To add user into other groups use -G flag followed by comma seprarated group names.</p><p></p><p><img src="images/33-5.png" alt="images/33-5.png" /></p><p></p><p>To create a temporary user, we can set its expiration date with -e flag followed by date in format yyyy-mm-dd.</p><p></p><p>To change or display password expire policy of a user, use <strong>chage</strong> command .</p><p>To display password expiration policy add -l flag to chage command.</p><p></p><p><img src="images/33-6.png" alt="images/33-6.png" /></p><p></p><p>If a user has shell /usr/bin/nologin or /bin/false, then it means that it is a user which is only created to run a specific service or process. In linux, services such as web servers are recommended to run with their own accounts in which they cannot login to provide security. nologin shell displays that this user account doesn&#39;t exist while false is just a binary which exits returning false.</p><p></p><p>There is another command <strong>adduser</strong> which is actually a perl script which uses useradd at backend but is easy to use. There is no difference between functionality of both commands.</p><p></p><p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p><p></p><p>The commands which deal with user management are only modifying some special files like /etc/passwd, /etc/shadow etc.</p><p></p><p><strong>usermod</strong> command is used to change a user&#39;s properties. It uses same options as useradd.</p><p></p><p><img src="images/33-7.png" alt="images/33-7.png" /></p><p></p><p><strong>-g</strong> flag can be used to change user&#39;s primary group. -G can be used to change secondary groups of user. When changing user&#39;s secondary groups, user is automatically removed from group names not specified. For example we wriite below command :</p><p></p><p><div class="codebox"><pre>usermod -G root,appple james</pre></div></p><p></p><p>Let us assume james is member of admin and manager group already. But if we write above command, james will be removed from those group automatically until we specify admin and manager groups above. To get rid of this behaviour we have to use -a flag.</p><p></p><p><div class="codebox"><pre>usermod -aG root,appple james</pre></div></p><p></p><p>To delete a user use <strong>userdel</strong> command. By default, userdel only removes user and doesn&#39;t removes it&#39;s primary group, home directory etc. To remove those, use -r flag with usedel.</p><p></p><p>Note that userdel doesn&#39;t delete file associated with user in other locations, we have to manually search and delete those files.</p><p></p><p>Like adduser there is also an deluser command which is used to delete user with userdel as backend but with good interface.</p><p></p><p></p><p><h2>Creating admin users</h2><span style="text-decoration:underline;"></span></p><p><span style="text-decoration:underline;"></span></p><p>In Linux only user which was created at the beginning can user adminsitrative commands when prefixed with sudo keyword.</p><p></p><p>Let&#39;s see an example. We have james user we created earlier. He has no admin rights. Let&#39;s log into his account and check if he can run admin command.</p><p></p><p><img src="images/33-8.png" alt="images/33-8.png" /></p><p></p><p>We can see that we cannot use james&#39;s account to read /etc/shadow.</p><p></p><p>To give admin rights to a user, we have to add it into <strong>sudo</strong> group in debian based distros and <strong>wheel</strong> group in cent os.</p><p></p><p><img src="images/33-9.png" alt="images/33-9.png" /></p><p></p><p>We added james to sudo group and now it can perform admin tasks.</p></div>
</body>
</html>
