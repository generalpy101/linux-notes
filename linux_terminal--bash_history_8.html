<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>bash history</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>bash history</h1><br/><p>The linux shell stores previously written commands. This helps us to repeat our previous commands without writing them again. </p><p></p><p>There are 2 places where linux command history is stored  :-</p><p></p><p>1. <strong>bash_history file</strong> : First storage is bash_history file which is store in user&#39;s home directory which can be accessed be ~. Maximum number of commands stored by it can be determined by <strong>HISTFILESIZE</strong> environment variable. By default it is 2000. bash_history file is a hidden file so its name is appended by .(dot). </p><p>Result of <em>cat .bash_history</em> :-</p><p><img src="images/8-1.png" alt="images/8-1.png" /></p><p>2. <strong>In memory storage / realtime storage</strong> : Second storage location is in memory. Here commands are stored in realtime. Maximum number of commands stored is determined by <strong>HISTSIZE</strong> environment variable. By default it is 1000. This can be accessed and manipulated by <em><strong>history</strong></em> command.</p><p>Result of history command :-</p><p><img src="images/8-2.png" alt="images/8-2.png" /></p><p>In display of history command, commands are numbered by when they were executed, number 1 comand first and so on.</p><p></p><p>Values of HISTFILESIZE and HISTSIZE.</p><p><img src="images/8-3.png" alt="images/8-3.png" /></p><p></p><p><em><strong><span style="text-decoration:underline;">Note </span></strong></em>:- <em>.bash_history file is not updated in realtime, it is updated once user logs out. history command is updated in realtime.</em></p><p><em></em></p><p><em>Output of history command before logging out.</em></p><p><em></em><img src="images/8-4.png" alt="images/8-4.png" /></p><p></p><p>Contents of bash_history file before logging out</p><p><img src="images/8-5.png" alt="images/8-5.png" /></p><p></p><p>Contents of bash_history file after logging out and logging in </p><p><img src="images/8-6.png" alt="images/8-6.png" /></p><p>As we can see contents of bash_history file matches to history command after logging out and logging in again.</p><p></p><p>There is more to this file and in memory stuff please refer google to study more.</p><p></p><p><strong>History navigation in shell</strong> :-</p><p><em></em></p><p><em></em><strong>Up arrow key or Ctrl + p</strong> : Used to move up in the history</p><p></p><p><strong>Down arrow key or Ctrl + n</strong> : Used to move down in the history</p><p></p><p><strong>!!</strong> : Used to execute last used command</p><p></p><p><strong>!&lt;command_name&gt;</strong> : Used to execute last executed instance on any command. Eg : !ping will run last executed ping command</p><p></p><p><strong>!&lt;line_number&gt;</strong> : Used to execute command at line number in history. Line number can be negative which counts line number from bottom(like python list indexing).Eg: !34 will execute command at line 34 in history, !-7 will execute 7th command from the ending of history(not history file).</p><p></p><p><strong>!&lt;name or line number&gt;:p</strong> : Used to print commands instead of executing them. Number or command name can be provided which will have effect like last 2 commands.</p><p></p><p><strong>Ctrl + r</strong> : Enters into recall mode(kinda like search mode). After pressing this key combination enter name of the command you want to search and it will try to match your string with history. When you find the desired press Enter to execute it or Ctrl + Alt + p to place it in current line and then you can press enter to execute it. If you do not want to execute command or want to exit from recall mode you can use Ctrl + g to exit recall mode.</p><p></p><p><strong>To delete history</strong> :-</p><p></p><p><strong>history -d &lt;line number&gt;</strong> : Delete a particular line number from  history.</p><p></p><p><strong>history -c </strong>: To clear whole history.</p><p><a href="https://askubuntu.com/questions/191999/how-to-clear-bash-history-completely">How to complete bash history completely</a></p><p><a href="https://www.journaldev.com/35489/dev-null-in-linux">More on /dev/null</a></p><p><a href="https://www.digitalocean.com/community/tutorials/how-to-use-bash-history-commands-and-expansions-on-a-linux-vps">More on Bash history</a></p><p></p><p></p><p><strong>HISTCONTROL environment variable</strong> : This variable controls which commands are stored in the history. It can have 4 different values :-</p><p></p><p>1. <strong>ignoredup</strong>s : This value ensures that immediate duplicates are ignored in the history. If this option is set, then line same as there immediate previous line are not stored in history.</p><p></p><p>History with ignoredups unset, note how 3 cd commads are there consecutively</p><p><img src="images/8-7.png" alt="images/8-7.png" /></p><p>History with ignoredups set,note how cd wasn&#39;t recorded 2 times as they were 2 immediate duplicate of each other</p><p><img src="images/8-8.png" alt="images/8-8.png" /></p><p></p><p>2. <strong>ignorespace</strong> : Causes line starting with white space not to be included in history.</p><p></p><p>History with ignorespace unset, note how cd and echo commands beginning with whitespace are recorded</p><p><img src="images/8-9.png" alt="images/8-9.png" /></p><p>History with ignorespace set, note how cd command is not stored in history</p><p><img src="images/8-10.png" alt="images/8-10.png" /></p><p></p><p>This technique can be used to type commands anonymously, without a record of them in history.</p><p></p><p>3. <strong>ignoreboth</strong> : Mixture of ignorespace and ignoredups, default in ubuntu. </p><p></p><p>4. <strong>erasedups</strong> : It allows all lines matching from current line to be deleted before the line is saved.</p><p>erasedups is set here</p><p><img src="images/8-11.png" alt="images/8-11.png" /></p><p>I&#39;&#39;ll write cd command again which is already there in history.</p><p><img src="images/8-12.png" alt="images/8-12.png" /></p><p>Note how previous instance of cd is removed.</p><p><a href="https://www.geeksforgeeks.org/histcontrol-command-in-linux-with-examples/">More on HISTCONTROL</a></p><p></p><p><em><strong><span style="text-decoration:underline;">Note</span></strong></em> :- <em>Setting environment variables in current terminal is temporary, if you restart the terminal their values will be reverted to default. To save your values, you have to save them in </em><em><strong>.bashrc</strong></em><em> file present in user home directory. More on this later.</em></p><p></p><p><strong><span style="text-decoration:underline;">Record date and time in history</span></strong><strong> :</strong>-</p><p></p><p><strong>HISTTIMEFORMAT</strong> environment variable determines the format in which time is shown in history. By default it is empty in my Ubuntu.</p><p></p><p><em>Empty HISTTIMEFORMAT</em></p><p><img src="images/8-13.png" alt="images/8-13.png" /></p><p></p><p>We can set its value to display time and date in history.</p><p>History before and after setting HISTTIMEFORMAT</p><p></p><p><img src="images/8-14.png" alt="images/8-14.png" /></p><p>In HISTTIMEFORMAT format, d stands for date, m for month, y for year and T for time. % is used to denote that they are variables.</p><p></p><p><a href="https://www.geeksforgeeks.org/histtimeformat-variable-in-linux-with-example/">More on HISTTIMEFORMAT</a></p></div>
</body>
</html>
